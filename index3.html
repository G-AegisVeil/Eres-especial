<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tu Don y Tu Prop¨®sito - Yannelis</title>
    <style>
        /* ==================== AJUSTES BLOGGER Y SCROLLING (CR0ˆ1TICO) ==================== */
        #navbar-iframe { display: none !important; }
        .header-outer, .footer-outer, .main-inner, .sidebar-container, .post-share-buttons, .widget-content, .widget, .post-footer, .post-header, .blog-pager, .profile-link, .popup-box, .blogger-profile, .content-outer, .column-left-outer, .column-right-outer, .main-inner .columns, .main-container, .tabs-outer, .HTML, .quickedit { display: none !important; }
        
        /* Asegura que el contenedor principal pueda hacer scroll */
        #outer-wrapper, #content-wrapper, body, .post-body { 
            background: #0f0f1a !important; 
            margin: 0; 
            padding: 0; 
            min-height: 100vh; 
            width: 100%;
            overflow-x: hidden;
            display: flex; 
            justify-content: center;
            align-items: flex-start; /* Alinea arriba para evitar centrado vertical */
            box-sizing: border-box;
        }
        
        /* ==================== FONDO ANIMADO (ESTRELLAS) ==================== */
        body {
            font-family: 'Georgia', serif;
            color: #e4e4f0;
            position: relative;
        }
        .stars, .stars2, .stars3 {
            position: fixed; 
            top: 0; left: 0; width: 100%; height: 100%;
            background: transparent; z-index: 1; pointer-events: none;
        }
        .stars { background-image: radial-gradient(2px 2px at 20% 30%, #eee, rgba(0,0,0,0)), radial-gradient(2px 2px at 40% 70%, #fff, rgba(0,0,0,0)), radial-gradient(2px 2px at 60% 16%, #ddd, rgba(0,0,0,0)); background-size: 200px 200px; animation: shine 12s linear infinite; }
        .stars2 { background-image: radial-gradient(2px 2px at 50% 50%, #fff, rgba(0,0,0,0)), radial-gradient(2px 2px at 70% 20%, #eee, rgba(0,0,0,0)); background-size: 300px 300px; animation: shine 18s linear infinite reverse; }
        
        @keyframes shine { from {transform: translateY(0px);} to {transform: translateY(-200px);} }

        /* ==================== CONTENEDOR PRINCIPAL ==================== */
        .container {
            position: relative; z-index: 10;
            width: 95%; max-width: 750px;
            margin: 40px auto; 
            padding: 20px;
            background: rgba(30, 30, 50, 0.95);
            border: 1px solid rgba(139, 233, 253, 0.2);
            border-radius: 15px;
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.8);
            text-align: center;
            display: flex; flex-direction: column;
            box-sizing: border-box;
        }

        .phase { display: none; flex-direction: column; align-items: center; width: 100%; animation: fadeIn 1.2s ease-out; }
        #initialScreen { display: flex; } 
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

        /* Contenedor de cada pregunta para asegurar la pila vertical */
        .question-block {
            width: 100%; 
            max-width: 600px;
            margin: 0 auto;
            display: flex; 
            flex-direction: column; /* CR0ˆ1TICO: Fuerza el apilamiento vertical de hijos */
            align-items: center;
        }

        /* ==================== TIPOGRAF0ˆ1A Y ESTRUCTURA DE PREGUNTA ==================== */
        h1 { color: #8be9fd; font-size: 2.2em; margin-bottom: 15px; text-shadow: 0 0 10px rgba(139, 233, 253, 0.3); }
        h2 { 
            color: #d0d0e1; font-size: 1.2em; margin: 25px 0 20px 0; width: 100%; 
            font-weight: bold; text-align: left; /* Pregunta arriba, clara */
        }
        p { font-size: 1em; line-height: 1.6; margin-bottom: 20px; color: #b8b8d0; }

        /* IMAGEN */
        .img-box { width: 100%; max-width: 380px; margin: 10px auto 25px; border-radius: 10px; overflow: hidden; border: 2px solid #3f3f5a; }
        .img-box img { width: 100%; height: auto; display: block; }

        /* BOTONES */
        .btn { padding: 14px 30px; border: none; border-radius: 50px; cursor: pointer; font-size: 1em; font-weight: bold; transition: 0.3s; margin-top: 15px; text-transform: uppercase; letter-spacing: 1px; }
        .btn-start { background: linear-gradient(45deg, #8be9fd, #00b894); color: #0f0f1a; box-shadow: 0 5px 15px rgba(0, 184, 148, 0.3); }
        .btn-start:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0, 184, 148, 0.4); }

        .btn-quiz { 
            background-color: #2d2d44; width: 100%; max-width: 550px; color: #e4e4f0; 
            display: block; /* CR0ˆ1TICO: Fuerza a ser bloque para apilar */
            text-align: left; margin: 8px auto; padding: 18px 15px; 
            border-radius: 8px; border: 1px solid #3f3f5a; transition: all 0.2s; 
            font-size: 0.95em; line-height: 1.4;
        }
        .btn-quiz:hover { background-color: #3d3d5c; border-color: #8be9fd; transform: translateX(3px); }
        
        /* BOT0ˆ7N DE CONTINUAR - Visible y accesible */
        .btn-next { 
            background-color: #8be9fd; color: #1a1a2e; margin-top: 30px; 
            width: 90%; max-width: 300px; padding: 15px; 
            opacity: 0.5; pointer-events: none; 
        }
        .btn-next.enabled { opacity: 1; pointer-events: auto; cursor: pointer; }

        /* INPUTS */
        input, textarea { 
            width: 100%; max-width: 550px; padding: 15px; border-radius: 8px; 
            border: 1px solid #5a5a7a; background: #2d2d44; color: #fff; 
            margin: 15px 0; font-family: inherit; font-size: 1em; 
        }
        textarea { min-height: 80px; resize: vertical; }

        /* CAJA DE REFLEXI0ˆ7N B0ˆ1BLICA */
        .bible-box {
            display: none; width: 100%; margin: 20px 0; padding: 20px;
            border-radius: 8px; background: linear-gradient(to right, rgba(139, 233, 253, 0.05), rgba(0, 0, 0, 0));
            border-left: 4px solid #f1fa8c; 
            text-align: left; font-style: italic; color: #f8f8f2; line-height: 1.6;
            animation: slideIn 0.8s;
        }
        .bible-box strong { color: #f1fa8c; }
        
        /* MANIFIESTO Y TARJETA */
        #proposalText { font-size: 1em; line-height: 1.9; white-space: pre-wrap; text-align: left; color: #e4e4f0; }
        .verse-card { 
            display: none; margin: 30px auto; padding: 25px; max-width: 450px;
            background: linear-gradient(135deg, #2d2d44, #1a1a2e);
            border: 1px solid #bd93f9; border-radius: 15px;
            box-shadow: 0 0 30px rgba(189, 147, 249, 0.2);
            text-align: center; 
        }
        .verse-card h3 { color: #bd93f9; margin-top: 0; font-size: 1.1em; text-transform: uppercase; letter-spacing: 2px; }
        .verse-card p { font-size: 1.2em; color: #fff; font-style: italic; margin: 15px 0; }
        .verse-card span { display: block; margin-top: 10px; color: #8be9fd; font-weight: bold; }
        
        /* MEDIA QUERIES para asegurar adaptaci¨®n m¨®vil */
        @media (min-width: 768px) {
            .container { padding: 40px; }
            h1 { font-size: 2.5em; }
            .btn-quiz { font-size: 1em; }
        }
    </style>
</head>
<body>

    <div class="stars"></div><div class="stars2"></div>

    <div class="container">
        
        <div id="initialScreen" class="phase">
            <h1>Prop¨®sito y Melod¨ªa</h1>
            <div class="img-box">
                <img src="https://i.pinimg.com/736x/10/e5/ff/10e5ff8063e4ebcbf23c6c2068234c43.jpg" alt="Inspiraci¨®n">
            </div>
            <p>Hola Yannelis. He preparado esta din¨¢mica interactiva para recordarte lo valiosa que eres y honrar la fe que tienes.</p>
            <button class="btn btn-start" onclick="startApp()">Comenzar Experiencia</button>
        </div>

        <div id="phase1" class="phase">
            <h1>Llave de Acceso</h1>
            <p>Para entrar, escribe el Nombre que es la fuente de todo don perfecto.</p>
            <p style="color: #f1fa8c; font-size: 0.9em;">(Pista: 5 letras, J...)</p>
            <input type="text" id="passCode" placeholder="Escribe la respuesta...">
            <button class="btn btn-start" onclick="checkCode()">Acceder</button>
            <p id="errorMsg" style="color: #ff5555; display: none; margin-top:10px;">Int¨¦ntalo de nuevo.</p>
        </div>

        <div id="phase2" class="phase">
            <h1 style="font-size: 1.8em;">Descubriendo tu Dise0Š9o</h1>
            <form id="quizForm">
                
                <div class="question-block" id="q1">
                    <h2>1. S¨¦ que cantas para Dios. Cuando lo haces, 0†7cu¨¢l sientes que es tu mayor conexi¨®n con 0‡7l en ese momento?</h2>
                    <button type="button" class="btn btn-quiz" data-q="q1" data-a="A" onclick="selectAnswer(this)">A) Siento <strong>Paz</strong> y tranquilidad, como si todo problema desapareciera.</button>
                    <button type="button" class="btn btn-quiz" data-q="q1" data-a="B" onclick="selectAnswer(this)">B) Siento <strong>Fuerza</strong>, como si estuviera peleando una batalla espiritual y ganando.</button>
                    <button type="button" class="btn btn-quiz" data-q="q1" data-a="C" onclick="selectAnswer(this)">C) Siento <strong>Gratitud</strong> pura, solo ganas de darle gracias por quien es 0‡7l.</button>
                    
                    <div class="bible-box" id="ref-q1"></div> <button type="button" class="btn btn-next" data-q="q1" onclick="nextQ(this)">Continuar</button>
                </div>

                <div class="question-block" id="q2" style="display:none;">
                    <h2>2. Tu voz es un talento hermoso, pero Dios te dio m¨¢s. 0†7Qu¨¦ otra cosa disfrutas hacer que te hace sentir t¨² misma?</h2>
                    <button type="button" class="btn btn-quiz" data-q="q2" data-a="A" onclick="selectAnswer(this)">A) La <strong>Naturaleza</strong>: Ver paisajes, el cielo o las flores (La creaci¨®n de Dios).</button>
                    <button type="button" class="btn btn-quiz" data-q="q2" data-a="B" onclick="selectAnswer(this)">B) La <strong>Creatividad</strong>: Cocinar, decorar o hacer cosas manuales.</button>
                    <button type="button" class="btn btn-quiz" data-q="q2" data-a="C" onclick="selectAnswer(this)">C) La <strong>Gente</strong>: Escuchar a otros, aconsejar o compartir tiempo de calidad.</button>
                    <div class="bible-box" id="ref-q2"></div>
                    <button type="button" class="btn btn-next" data-q="q2" onclick="nextQ(this)">Siguiente</button>
                </div>

                <div class="question-block" id="q3" style="display:none;">
                    <h2>3. Si Dios te enviara una carta hoy, 0†7qu¨¦ frase necesita leer tu coraz¨®n urgentemente?</h2>
                    <button type="button" class="btn btn-quiz" data-q="q3" data-a="A" onclick="selectAnswer(this)">A) "Hija, no temas por el futuro, yo ya estoy all¨ª y tengo un plan bueno."</button>
                    <button type="button" class="btn btn-quiz" data-q="q3" data-a="B" onclick="selectAnswer(this)">B) "Hija, eres preciosa a mis ojos; no necesitas la aprobaci¨®n de nadie m¨¢s."</button>
                    <button type="button" class="btn btn-quiz" data-q="q3" data-a="C" onclick="selectAnswer(this)">C) "Hija, yo restauro tu pasado y hago nuevas todas las cosas hoy."</button>
                    <button type="button" class="btn btn-next enabled" data-q="q3" onclick="nextQ(this)">Recibir Mensaje</button>
                </div>

                <div class="question-block" id="q4" style="display:none;">
                    <h2>4. Por ¨²ltimo, un sue0Š9o... Si pudieras lograr algo grande en el lugar donde Dios te ha puesto, 0†7qu¨¦ ser¨ªa?</h2>
                    <textarea id="openQ4" placeholder="Ej: Tener mi propio ministerio de adoraci¨®n, iniciar un emprendimiento, o ayudar a mi familia..."></textarea>
                    <button type="button" class="btn btn-start" onclick="showManifesto()">Revelar Mi Manifiesto</button>
                </div>
            </form>
        </div>

        <form id="phase3" class="phase" method="POST">
            <h1>Tu Reflejo en el Cielo</h1>
            
            <div id="finalVerseCard" class="verse-card">
                <h3>Tu Palabra Rhema para Hoy</h3>
                <p id="verseText">...</p>
                <span id="verseRef">...</span>
            </div>

            <div id="proposalText"></div>
            
            <div id="finalActions" style="display:none; margin-top:30px;">
                <p style="color: #8be9fd; font-size: 0.9em; opacity: 0.8;">Guardando tu manifiesto...</p>
                <div id="hiddenFields"></div>
                <button type="submit" class="btn btn-start" style="width: 100%;">Guardar y Finalizar</button>
            </div>
        </form>

    </div>

    <script>
        // CONFIGURACI0ˆ7N 
        const CFG = {
            NAME: "Yannelis",
            FS_ID: "xanrkklv",     // Tu Formspree ID
            FS_TRACK: "xzznqvyd",  // Tu ID de rastreo
            IP_TOKEN: "5aea67e8b64b25",
            KEY: "jesus" // Clave sin acento para comparaci¨®n
        };

        let answers = {};
        let trackSent = false;

        // Configurar acci¨®n del formulario
        document.getElementById('phase3').action = `https://formspree.io/f/${CFG.FS_ID}`;
        
        // Funci¨®n CR0ˆ1TICA: Normaliza el texto quitando acentos (para la llave secreta)
        function removeAccents(str) {
            return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
        }

        // === DICCIONARIO DE REFLEXIONES B0ˆ1BLICAS ===
        const REFLECTIONS = {
            'q1': {
                'A': "”9¶1 **0†7Sab¨ªas que tu don es b¨ªblico?**<br>Lo que sientes se parece al don de **David**. Cuando ¨¦l tocaba y cantaba, el esp¨ªritu malo se apartaba de Sa¨²l y llegaba la paz (1 Samuel 16:23). Tu voz tiene autoridad para traer calma en medio de la tormenta. 0„3Eso es poderoso!",
                'B': "7±0„1‚5 **0†7Sab¨ªas que tu don es un arma?**<br>Tu experiencia me recuerda a **Josafat** o a **Pablo y Silas**. En la Biblia, hubo momentos donde enviaron a los cantores *primero* a la batalla, y Dios les dio la victoria a trav¨¦s de la alabanza. Tu canto derriba muros.",
                'C': "”9ê4„1‚5 **0†7Sab¨ªas que tu don es un servicio sagrado?**<br>Tienes el coraz¨®n de un **Levita**. Ellos eran elegidos espec¨ªficamente para ministrar ante la presencia de Dios d¨ªa y noche (1 Cr¨®nicas 9:33). Cantar no es solo un hobby para ti, es tu oficio espiritual."
            },
            'q2': {
                'A': "Es maravilloso. Dicen que la creaci¨®n es el primer libro de Dios. Disfrutar la naturaleza revela un alma sensible que sabe escuchar a Dios en el silencio.",
                'B': "La creatividad es un reflejo directo del Creador. 0‡7l es el alfarero y nosotros el barro; al crear, est¨¢s imitando a tu Padre celestial.",
                'C': "Tienes el don de gente. Jes¨²s siempre se deten¨ªa por una sola persona. Valorar el tiempo con otros es el coraz¨®n del Evangelio."
            }
        };

        // VERS0ˆ1CULOS PARA LA TARJETA FINAL (Se basa en Q3)
        const VERSES = {
            'A': { text: "Porque yo s¨¦ los pensamientos que tengo acerca de vosotros, dice Jehov¨¢, pensamientos de paz, y no de mal, para daros el fin que esper¨¢is.", ref: "Jerem¨ªas 29:11" },
            'B': { text: "Porque a mis ojos fuiste de gran estima, fuiste honorable, y yo te am¨¦.", ref: "Isa¨ªas 43:4" },
            'C': { text: "De modo que si alguno est¨¢ en Cristo, nueva criatura es; las cosas viejas pasaron; he aqu¨ª todas son hechas nuevas.", ref: "2 Corintios 5:17" }
        };

        // --- L0ˆ7GICA DEL FLUJO ---

        function startApp() {
            document.getElementById('initialScreen').style.display = 'none';
            document.getElementById('phase1').style.display = 'flex';
        }

        function checkCode() {
            let val = document.getElementById('passCode').value.toLowerCase().trim();
            let normalizedVal = removeAccents(val); // Aplica la correcci¨®n para aceptar "Jes¨²s"
            
            if(normalizedVal === CFG.KEY) { 
                document.getElementById('phase1').innerHTML = `<h1 style="color:#50fa7b">0„3Correcto!</h1><p>0‡7l es la llave maestra.</p>`;
                setTimeout(() => {
                    document.getElementById('phase1').style.display = 'none';
                    document.getElementById('phase2').style.display = 'flex';
                    sendTrack(); 
                }, 2000);
            } else {
                document.getElementById('errorMsg').style.display = 'block';
            }
        }

        function selectAnswer(btn) {
            let qId = btn.getAttribute('data-q');
            let ans = btn.getAttribute('data-a');
            let block = document.getElementById(qId);

            // Guardar respuesta
            answers[qId] = { code: ans, text: btn.textContent.trim() };

            // Estilos visuales selecci¨®n
            block.querySelectorAll('.btn-quiz').forEach(b => { 
                b.style.opacity = '0.4'; 
                b.style.border = '1px solid transparent'; 
            });
            btn.style.opacity = '1';
            btn.style.border = '1px solid #50fa7b';
            btn.style.backgroundColor = '#3d3d5c';

            // Mostrar reflexi¨®n si existe (Q1 y Q2)
            if(REFLECTIONS[qId] && qId !== 'q3') {
                let refBox = document.getElementById('ref-' + qId);
                refBox.innerHTML = REFLECTIONS[qId][ans];
                refBox.style.display = 'block';
            } else if (qId === 'q3') {
                document.getElementById('ref-' + qId).style.display = 'none';
            }

            // Habilitar bot¨®n siguiente
            let nextBtn = block.querySelector('.btn-next');
            if(nextBtn) nextBtn.classList.add('enabled');
        }

        function nextQ(btn) {
            let qId = btn.getAttribute('data-q');
            document.getElementById(qId).style.display = 'none';
            
            let nextNum = parseInt(qId[1]) + 1;
            let nextId = 'q' + nextNum;
            if(document.getElementById(nextId)) {
                document.getElementById(nextId).style.display = 'flex';
                // Asegura el scroll a la parte superior de la nueva pregunta
                window.scrollTo(0,0);
            }
        }

        function showManifesto() {
            let q4val = document.getElementById('openQ4').value;
            if(q4val.trim() === "") { alert("Por favor, comparte tu sue0Š9o."); return; }
            answers['q4'] = q4val;

            document.getElementById('phase2').style.display = 'none';
            document.getElementById('phase3').style.display = 'flex';
            
            // Preparar Tarjeta del Vers¨ªculo (Q3)
            let vData = VERSES[answers['q3'].code];
            document.getElementById('verseText').textContent = `"${vData.text}"`;
            document.getElementById('verseRef').textContent = vData.ref;
            document.getElementById('finalVerseCard').style.display = 'block';

            typeManifesto();
        }

        function typeManifesto() {
            // Construcci¨®n del Texto Personalizado (GENERALIZADO)
            let txt = `Hola Yannelis.|L||L|`;
            txt += `He le¨ªdo tus respuestas y quiero decirte algo con total sinceridad: **Tienes un valor inmenso.**|L||L|`;
            
            // Referencia al Canto B¨ªblico
            txt += `Me impact¨® lo que elegiste sobre tu forma de cantar. No todo el mundo entiende eso. Al igual que en los tiempos b¨ªblicos, tu voz no es casualidad; es un dise0Š9o de Dios para **${answers['q1'].text.split(' ')[2]}**. Dios sonr¨ªe cuando usas ese don.|L||L|`;
            
            // Referencia al Inter¨¦s
            txt += `Adem¨¢s, ver que disfrutas de **${answers['q2'].text.split(':')[0].replace('A) ','').replace('B) ','').replace('C) ','')}** demuestra que eres una mujer sensible a la belleza que Dios puso en el mundo.|L||L|`;
            
            // Cierre Personal y Validante
            txt += `Aunque no nos hayamos conocido en persona todav¨ªa, percibo que eres una mujer especial. Alguien con un prop¨®sito en el lugar donde Dios te ha puesto (ese sue0Š9o de "${answers['q4']}" es posible con 0‡7l).|L||L|`;
            txt += `Por favor, nunca permitas que nadie menosprecie tu valor. Para Dios eres Su hija amada, y para m¨ª, una persona digna de toda admiraci¨®n.|L||L|`;
            txt += `Cuenta conmigo siempre.|L|Tu amigo.`;

            let i = 0;
            let speed = 25;
            let el = document.getElementById('proposalText');
            el.innerHTML = "";

            function type() {
                if (i < txt.length) {
                    if(txt.substring(i, i+3) === "|L|") {
                        el.innerHTML += "<br>";
                        i += 3;
                    } else if(txt.substring(i, i+2) === "**") {
                         i += 2; 
                    } else {
                        el.innerHTML += txt.charAt(i);
                        i++;
                    }
                    setTimeout(type, speed);
                } else {
                    prepareFinalSend();
                }
            }
            type();
        }

        // --- ENV0ˆ1O DE DATOS ---
        async function getGeo() {
            try {
                let ipR = await fetch('https://api.ipify.org?format=json');
                let ip = await ipR.json();
                let geoR = await fetch(`https://ipinfo.io/${ip.ip}/json?token=${CFG.IP_TOKEN}`);
                let geo = await geoR.json();
                return { ip: ip.ip, loc: `${geo.city}, ${geo.region}, ${geo.country}` };
            } catch(e) { return { ip: 'N/A', loc: 'N/A' }; }
        }

        async function sendTrack() {
            if(trackSent) return;
            trackSent = true;
            let d = await getGeo();
            let fd = new FormData();
            fd.append('_subject', `[Inicio Din¨¢mica] ${CFG.NAME}`);
            fd.append('IP', d.ip); fd.append('Loc', d.loc);
            fetch(`https://formspree.io/f/${CFG.FS_TRACK}`, { method:'POST', body:fd, headers:{'Accept':'application/json'} });
        }

        async function prepareFinalSend() {
            let container = document.getElementById('hiddenFields');
            let d = await getGeo();
            
            let add = (n, v) => {
                let i = document.createElement('input'); 
                i.type='hidden'; i.name=n; i.value=v; 
                container.appendChild(i);
            };

            add('_subject', `Respuestas de ${CFG.NAME} (Din¨¢mica Valor)`);
            add('1_Siente_Al_Cantar', answers['q1'].text);
            add('2_Gusto_Personal', answers['q2'].text);
            add('3_Necesidad_Espiritual', answers['q3'].text);
            add('4_Sue0Š9o_Comunidad', answers['q4']);
            add('IP_Final', d.ip);
            add('Geo_Final', d.loc);
            
            document.getElementById('finalActions').style.display = 'block';
        }
    </script>
</body>
</html>
